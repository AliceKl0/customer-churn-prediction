# Customer Churn Prediction - ML Project

Предсказание оттока клиентов банка.

## Технологии

- **Python 3.8+**
- **pandas** - работа с данными
- **seaborn** - визуализация данных
- **scikit-learn** - машинное обучение
- **matplotlib** - построение графиков
- **numpy** - численные вычисления
- **imbalanced-learn** - обработка дисбаланса классов
- **xgboost** - градиентный бустинг

## Структура проекта

```
customer-churn-prediction/
│
├── src/                    # Исходный код проекта
│   ├── __init__.py
│   ├── data_loader.py     # Загрузка данных
│   ├── eda.py             # Исследовательский анализ данных
│   ├── model_training.py  # Обучение и оценка моделей
│   └── utils.py           # Вспомогательные функции
│
├── data/                   # Данные проекта
│   ├── raw/               # Исходные данные (README.md с инструкциями)
│   └── processed/         # Обработанные данные (README.md с инструкциями)
│
├── notebooks/              # Jupyter notebooks для исследования
│   └── (для будущих исследований)
│
├── models/                 # Сохраненные модели
│   └── best_model.pkl     # Лучшая обученная модель
│
├── main.py                 # Точка входа в проект
├── requirements.txt        # Зависимости проекта
├── README.md               # Документация
└── .gitignore             # Игнорируемые файлы
```

## Установка и запуск

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd customer-churn-prediction
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

**Примечание для macOS:** Если XGBoost не работает, установите OpenMP:
```bash
brew install libomp
```

3. Запустите проект:
```bash
python main.py
```

**Важно:** Проект работает и без XGBoost. Если библиотека недоступна, будут использованы только Logistic Regression и Random Forest.

## Результаты

После выполнения скрипта будут созданы следующие визуализации:

- `eda_visualizations.png` - исследовательский анализ данных
- `correlation_matrix.png` - корреляционная матрица признаков
- `model_performance.png` - сравнение производительности моделей
- `roc_curves.png` - ROC кривые моделей
- `feature_importance.png` - важность признаков

## Модели

В проекте используются несколько моделей машинного обучения:

1. **Logistic Regression** - логистическая регрессия (базовая модель)
2. **Random Forest** - случайный лес (ансамбль деревьев)
3. **XGBoost** - градиентный бустинг (опционально, требует OpenMP runtime)

Для лучшей модели выполняется **подбор гиперпараметров** с помощью GridSearchCV.

### Метрики оценки:
- **Accuracy** - точность классификации
- **Precision** - точность предсказаний
- **Recall** - полнота предсказаний
- **F1-score** - гармоническое среднее precision и recall
- **ROC-AUC** - площадь под ROC кривой

## Особенности проекта

### Feature Engineering
- Создание возрастных групп
- Отношение баланса к зарплате
- Признак "рисковый клиент"
- Взаимодействие признаков (age × credit_score)
- Нормализация признаков

### Обработка данных
- Автоматическая генерация синтетических данных (можно заменить на реальные)
- Кодирование категориальных переменных
- Масштабирование признаков (StandardScaler)
- **Обработка дисбаланса классов** с помощью SMOTE
- Разделение на train/test с сохранением пропорций классов

### Моделирование
- Сравнение нескольких алгоритмов
- Кросс-валидация (5-fold) для оценки моделей
- Подбор гиперпараметров для лучшей модели
- Детальный анализ важности признаков
- Визуализация результатов (confusion matrix, ROC curves)

## Автор

Проект создан для портфолио и демонстрации навыков в области анализа данных и машинного обучения.

